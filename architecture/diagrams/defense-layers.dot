digraph DefenseLayers {
    rankdir=TB;
    node [shape=box, style=filled, fontname="Arial"];
    
    // Title
    label="8-Layer Defense-in-Depth Architecture";
    labelloc=t;
    fontsize=20;
    
    // Supply Chain Security (Blue gradient)
    subgraph cluster_supply {
        label="Supply Chain Security";
        style=filled;
        color=lightblue;
        
        layer1 [label="Layer 1: Image Signing\n(Cosign Keyless OIDC)", fillcolor="#E3F2FD"];
        layer2 [label="Layer 2: SBOM Analysis\n(Syft - 2,850 components)", fillcolor="#BBDEFB"];
        layer3 [label="Layer 3: VEX Filtering\n(60-70% noise reduction)", fillcolor="#90CAF9"];
        layer4 [label="Layer 4: SLSA Provenance\n(Build integrity)", fillcolor="#64B5F6"];
        layer5 [label="Layer 5: Admission Control\n(Kyverno enforcement)", fillcolor="#42A5F5"];
        
        layer1 -> layer2 -> layer3 -> layer4 -> layer5;
    }
    
    // Runtime Security (Green gradient)
    subgraph cluster_runtime {
        label="Runtime Security";
        style=filled;
        color=lightgreen;
        
        layer6 [label="Layer 6: Runtime Detection\n(Falco eBPF)", fillcolor="#C8E6C9"];
        layer7 [label="Layer 7: Secrets Management\n(External Secrets + Key Vault)", fillcolor="#A5D6A7"];
        layer8 [label="Layer 8: Network Microsegmentation\n(Calico zero-trust)", fillcolor="#81C784"];
        
        layer6 -> layer7 -> layer8;
    }
    
    // Flow
    layer5 -> layer6 [label="Deployment", style=dashed];
    
    // Attack Prevention
    attack1 [label="SolarWinds\nBreach", shape=ellipse, fillcolor="#FFCDD2"];
    attack2 [label="Log4Shell\nResponse", shape=ellipse, fillcolor="#FFCDD2"];
    attack3 [label="Capital One\nBreach", shape=ellipse, fillcolor="#FFCDD2"];
    
    layer4 -> attack1 [label="Prevents", color=red, style=bold];
    layer2 -> attack2 [label="96% faster", color=red, style=bold];
    layer8 -> attack3 [label="Prevents", color=red, style=bold];
}
