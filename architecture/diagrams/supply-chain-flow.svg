<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.42.4 (0)
 -->
<!-- Title: SupplyChain Pages: 1 -->
<svg width="2145pt" height="203pt"
 viewBox="0.00 0.00 2144.75 203.12" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 199.12)">
<title>SupplyChain</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-199.12 2140.75,-199.12 2140.75,4 -4,4"/>
<text text-anchor="middle" x="1068.38" y="-176.72" font-family="Times,serif" font-size="18.00">Secure Image Supply Chain Flow</text>
<g id="clust1" class="cluster">
<title>cluster_build</title>
<polygon fill="lightblue" stroke="lightblue" points="8,-62.12 8,-144.12 1082,-144.12 1082,-62.12 8,-62.12"/>
<text text-anchor="middle" x="545" y="-125.72" font-family="Times,serif" font-size="18.00">Build Phase (GitHub Actions)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_deploy</title>
<polygon fill="lightgreen" stroke="lightgreen" points="1301,-47.12 1301,-159.12 1770.42,-159.12 1770.42,-47.12 1301,-47.12"/>
<text text-anchor="middle" x="1535.71" y="-140.72" font-family="Times,serif" font-size="18.00">Deployment Phase (AKS Cluster)</text>
</g>
<!-- code -->
<g id="node1" class="node">
<title>code</title>
<polygon fill="#e3f2fd" stroke="black" points="111,-108.12 16,-108.12 16,-70.12 111,-70.12 111,-108.12"/>
<text text-anchor="middle" x="63.5" y="-92.92" font-family="Arial" font-size="14.00">Source Code</text>
<text text-anchor="middle" x="63.5" y="-77.92" font-family="Arial" font-size="14.00">(GitHub)</text>
</g>
<!-- build -->
<g id="node2" class="node">
<title>build</title>
<polygon fill="#bbdefb" stroke="black" points="241,-108.12 148,-108.12 148,-70.12 241,-70.12 241,-108.12"/>
<text text-anchor="middle" x="194.5" y="-92.92" font-family="Arial" font-size="14.00">Docker Build</text>
<text text-anchor="middle" x="194.5" y="-77.92" font-family="Arial" font-size="14.00">(Dockerfile)</text>
</g>
<!-- code&#45;&gt;build -->
<g id="edge1" class="edge">
<title>code&#45;&gt;build</title>
<path fill="none" stroke="black" d="M111.07,-89.12C119.68,-89.12 128.76,-89.12 137.61,-89.12"/>
<polygon fill="black" stroke="black" points="137.86,-92.63 147.86,-89.12 137.86,-85.63 137.86,-92.63"/>
</g>
<!-- sbom -->
<g id="node3" class="node">
<title>sbom</title>
<polygon fill="#90caf9" stroke="black" points="407,-108.12 278,-108.12 278,-70.12 407,-70.12 407,-108.12"/>
<text text-anchor="middle" x="342.5" y="-92.92" font-family="Arial" font-size="14.00">SBOM Generation</text>
<text text-anchor="middle" x="342.5" y="-77.92" font-family="Arial" font-size="14.00">(Syft)</text>
</g>
<!-- build&#45;&gt;sbom -->
<g id="edge2" class="edge">
<title>build&#45;&gt;sbom</title>
<path fill="none" stroke="black" d="M241.29,-89.12C249.74,-89.12 258.75,-89.12 267.78,-89.12"/>
<polygon fill="black" stroke="black" points="267.95,-92.63 277.95,-89.12 267.95,-85.63 267.95,-92.63"/>
</g>
<!-- scan -->
<g id="node4" class="node">
<title>scan</title>
<polygon fill="#64b5f6" stroke="black" points="569,-108.12 444,-108.12 444,-70.12 569,-70.12 569,-108.12"/>
<text text-anchor="middle" x="506.5" y="-92.92" font-family="Arial" font-size="14.00">Vulnerability Scan</text>
<text text-anchor="middle" x="506.5" y="-77.92" font-family="Arial" font-size="14.00">(Grype)</text>
</g>
<!-- sbom&#45;&gt;scan -->
<g id="edge3" class="edge">
<title>sbom&#45;&gt;scan</title>
<path fill="none" stroke="black" d="M407.06,-89.12C415.89,-89.12 425,-89.12 433.96,-89.12"/>
<polygon fill="black" stroke="black" points="433.98,-92.63 443.98,-89.12 433.98,-85.63 433.98,-92.63"/>
</g>
<!-- vex -->
<g id="node5" class="node">
<title>vex</title>
<polygon fill="#42a5f5" stroke="black" points="716,-108.12 606,-108.12 606,-70.12 716,-70.12 716,-108.12"/>
<text text-anchor="middle" x="661" y="-92.92" font-family="Arial" font-size="14.00">VEX Document</text>
<text text-anchor="middle" x="661" y="-77.92" font-family="Arial" font-size="14.00">(Reachability)</text>
</g>
<!-- scan&#45;&gt;vex -->
<g id="edge4" class="edge">
<title>scan&#45;&gt;vex</title>
<path fill="none" stroke="black" d="M569.09,-89.12C577.76,-89.12 586.7,-89.12 595.43,-89.12"/>
<polygon fill="black" stroke="black" points="595.55,-92.63 605.55,-89.12 595.55,-85.63 595.55,-92.63"/>
</g>
<!-- sign -->
<g id="node6" class="node">
<title>sign</title>
<polygon fill="#2196f3" stroke="black" points="871,-108.12 753,-108.12 753,-70.12 871,-70.12 871,-108.12"/>
<text text-anchor="middle" x="812" y="-92.92" font-family="Arial" font-size="14.00">Keyless Sign</text>
<text text-anchor="middle" x="812" y="-77.92" font-family="Arial" font-size="14.00">(Cosign + OIDC)</text>
</g>
<!-- vex&#45;&gt;sign -->
<g id="edge5" class="edge">
<title>vex&#45;&gt;sign</title>
<path fill="none" stroke="black" d="M716.21,-89.12C724.77,-89.12 733.7,-89.12 742.53,-89.12"/>
<polygon fill="black" stroke="black" points="742.81,-92.63 752.81,-89.12 742.81,-85.63 742.81,-92.63"/>
</g>
<!-- provenance -->
<g id="node7" class="node">
<title>provenance</title>
<polygon fill="#1976d2" stroke="black" points="1074,-108.12 947,-108.12 947,-70.12 1074,-70.12 1074,-108.12"/>
<text text-anchor="middle" x="1010.5" y="-92.92" font-family="Arial" font-size="14.00">SLSA Provenance</text>
<text text-anchor="middle" x="1010.5" y="-77.92" font-family="Arial" font-size="14.00">(GitHub Actions)</text>
</g>
<!-- sign&#45;&gt;provenance -->
<g id="edge6" class="edge">
<title>sign&#45;&gt;provenance</title>
<path fill="none" stroke="black" d="M871.16,-89.12C891.68,-89.12 915.01,-89.12 936.59,-89.12"/>
<polygon fill="black" stroke="black" points="936.69,-92.63 946.69,-89.12 936.69,-85.63 936.69,-92.63"/>
</g>
<!-- rekor -->
<g id="node15" class="node">
<title>rekor</title>
<path fill="#fff9c4" stroke="black" d="M1073,-47.6C1073,-50.24 1044.99,-52.38 1010.5,-52.38 976.01,-52.38 948,-50.24 948,-47.6 948,-47.6 948,-4.65 948,-4.65 948,-2.01 976.01,0.13 1010.5,0.13 1044.99,0.13 1073,-2.01 1073,-4.65 1073,-4.65 1073,-47.6 1073,-47.6"/>
<path fill="none" stroke="black" d="M1073,-47.6C1073,-44.97 1044.99,-42.83 1010.5,-42.83 976.01,-42.83 948,-44.97 948,-47.6"/>
<text text-anchor="middle" x="1010.5" y="-29.93" font-family="Arial" font-size="14.00">Rekor</text>
<text text-anchor="middle" x="1010.5" y="-14.93" font-family="Arial" font-size="14.00">Transparency Log</text>
</g>
<!-- sign&#45;&gt;rekor -->
<g id="edge14" class="edge">
<title>sign&#45;&gt;rekor</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M871.16,-70.48C892.16,-63.75 916.1,-56.07 938.1,-49.02"/>
<polygon fill="black" stroke="black" points="939.27,-52.32 947.73,-45.93 937.14,-45.65 939.27,-52.32"/>
<text text-anchor="middle" x="909" y="-67.92" font-family="Times,serif" font-size="14.00">Record</text>
</g>
<!-- registry -->
<g id="node8" class="node">
<title>registry</title>
<path fill="#fff9c4" stroke="black" d="M1251,-110.6C1251,-113.24 1225.45,-115.38 1194,-115.38 1162.55,-115.38 1137,-113.24 1137,-110.6 1137,-110.6 1137,-67.65 1137,-67.65 1137,-65.01 1162.55,-62.87 1194,-62.87 1225.45,-62.87 1251,-65.01 1251,-67.65 1251,-67.65 1251,-110.6 1251,-110.6"/>
<path fill="none" stroke="black" d="M1251,-110.6C1251,-107.97 1225.45,-105.83 1194,-105.83 1162.55,-105.83 1137,-107.97 1137,-110.6"/>
<text text-anchor="middle" x="1194" y="-92.92" font-family="Arial" font-size="14.00">Azure Container</text>
<text text-anchor="middle" x="1194" y="-77.92" font-family="Arial" font-size="14.00">Registry</text>
</g>
<!-- provenance&#45;&gt;registry -->
<g id="edge7" class="edge">
<title>provenance&#45;&gt;registry</title>
<path fill="none" stroke="black" d="M1074.22,-89.12C1091.1,-89.12 1109.42,-89.12 1126.51,-89.12"/>
<polygon fill="black" stroke="black" points="1126.96,-92.63 1136.96,-89.12 1126.96,-85.63 1126.96,-92.63"/>
<text text-anchor="middle" x="1105.5" y="-92.92" font-family="Times,serif" font-size="14.00">Push</text>
</g>
<!-- admission -->
<g id="node9" class="node">
<title>admission</title>
<polygon fill="#c8e6c9" stroke="black" points="1436,-108.12 1309,-108.12 1309,-70.12 1436,-70.12 1436,-108.12"/>
<text text-anchor="middle" x="1372.5" y="-92.92" font-family="Arial" font-size="14.00">Kyverno</text>
<text text-anchor="middle" x="1372.5" y="-77.92" font-family="Arial" font-size="14.00">Admission Control</text>
</g>
<!-- registry&#45;&gt;admission -->
<g id="edge10" class="edge">
<title>registry&#45;&gt;admission</title>
<path fill="none" stroke="black" d="M1251.33,-89.12C1266.39,-89.12 1282.89,-89.12 1298.7,-89.12"/>
<polygon fill="black" stroke="black" points="1298.97,-92.63 1308.97,-89.12 1298.97,-85.63 1298.97,-92.63"/>
<text text-anchor="middle" x="1280" y="-92.92" font-family="Times,serif" font-size="14.00">Pull</text>
</g>
<!-- verify -->
<g id="node10" class="node">
<title>verify</title>
<polygon fill="#a5d6a7" stroke="black" points="1571,-123.12 1473,-123.12 1473,-55.12 1571,-55.12 1571,-123.12"/>
<text text-anchor="middle" x="1522" y="-107.92" font-family="Arial" font-size="14.00">Verify:</text>
<text text-anchor="middle" x="1522" y="-92.92" font-family="Arial" font-size="14.00">• Signature</text>
<text text-anchor="middle" x="1522" y="-77.92" font-family="Arial" font-size="14.00">• SBOM</text>
<text text-anchor="middle" x="1522" y="-62.92" font-family="Arial" font-size="14.00">• Provenance</text>
</g>
<!-- admission&#45;&gt;verify -->
<g id="edge8" class="edge">
<title>admission&#45;&gt;verify</title>
<path fill="none" stroke="black" d="M1436.05,-89.12C1444.86,-89.12 1453.88,-89.12 1462.6,-89.12"/>
<polygon fill="black" stroke="black" points="1462.67,-92.63 1472.67,-89.12 1462.67,-85.63 1462.67,-92.63"/>
</g>
<!-- decision -->
<g id="node11" class="node">
<title>decision</title>
<polygon fill="#81c784" stroke="black" points="1685.21,-107.12 1607.79,-89.13 1685.21,-71.12 1762.63,-89.12 1685.21,-107.12"/>
<text text-anchor="middle" x="1685.21" y="-85.42" font-family="Arial" font-size="14.00">Allow/Deny</text>
</g>
<!-- verify&#45;&gt;decision -->
<g id="edge9" class="edge">
<title>verify&#45;&gt;decision</title>
<path fill="none" stroke="black" d="M1571.37,-89.12C1579.72,-89.12 1588.63,-89.12 1597.64,-89.12"/>
<polygon fill="black" stroke="black" points="1597.83,-92.63 1607.83,-89.12 1597.83,-85.63 1597.83,-92.63"/>
</g>
<!-- runtime -->
<g id="node12" class="node">
<title>runtime</title>
<polygon fill="#dcedc8" stroke="black" points="1991.59,-149.12 1850.59,-149.12 1850.59,-111.12 1991.59,-111.12 1991.59,-149.12"/>
<text text-anchor="middle" x="1921.09" y="-133.93" font-family="Arial" font-size="14.00">Running Pod</text>
<text text-anchor="middle" x="1921.09" y="-118.92" font-family="Arial" font-size="14.00">(Monitored by Falco)</text>
</g>
<!-- decision&#45;&gt;runtime -->
<g id="edge11" class="edge">
<title>decision&#45;&gt;runtime</title>
<path fill="none" stroke="green" stroke-width="2" d="M1729.93,-96.79C1760.86,-102.21 1803.24,-109.64 1840.14,-116.11"/>
<polygon fill="green" stroke="green" stroke-width="2" points="1839.94,-119.63 1850.39,-117.91 1841.15,-112.73 1839.94,-119.63"/>
<text text-anchor="middle" x="1805.42" y="-116.92" font-family="Times,serif" font-size="14.00">ALLOW</text>
</g>
<!-- deny -->
<g id="node14" class="node">
<title>deny</title>
<polygon fill="#ffcdd2" stroke="black" points="1993.92,-62.12 1957.51,-93.18 1884.67,-93.18 1848.25,-62.13 1884.67,-31.07 1957.51,-31.07 1993.92,-62.12"/>
<text text-anchor="middle" x="1921.09" y="-65.92" font-family="Arial" font-size="14.00">Deployment</text>
<text text-anchor="middle" x="1921.09" y="-50.92" font-family="Arial" font-size="14.00">Blocked</text>
</g>
<!-- decision&#45;&gt;deny -->
<g id="edge12" class="edge">
<title>decision&#45;&gt;deny</title>
<path fill="none" stroke="red" stroke-width="2" d="M1737.06,-83.17C1751.1,-81.53 1766.35,-79.75 1780.42,-78.12 1801.87,-75.64 1825.18,-72.97 1846.5,-70.52"/>
<polygon fill="red" stroke="red" stroke-width="2" points="1846.93,-74 1856.46,-69.38 1846.13,-67.04 1846.93,-74"/>
<text text-anchor="middle" x="1805.42" y="-81.92" font-family="Times,serif" font-size="14.00">DENY</text>
</g>
<!-- network -->
<g id="node13" class="node">
<title>network</title>
<polygon fill="#c5e1a5" stroke="black" points="2136.75,-149.12 2030.75,-149.12 2030.75,-111.12 2136.75,-111.12 2136.75,-149.12"/>
<text text-anchor="middle" x="2083.75" y="-133.93" font-family="Arial" font-size="14.00">Network Policy</text>
<text text-anchor="middle" x="2083.75" y="-118.92" font-family="Arial" font-size="14.00">(Calico)</text>
</g>
<!-- runtime&#45;&gt;network -->
<g id="edge13" class="edge">
<title>runtime&#45;&gt;network</title>
<path fill="none" stroke="black" d="M1991.62,-130.12C2001.21,-130.12 2011.02,-130.12 2020.46,-130.12"/>
<polygon fill="black" stroke="black" points="2020.55,-133.63 2030.55,-130.12 2020.55,-126.63 2020.55,-133.63"/>
</g>
</g>
</svg>
